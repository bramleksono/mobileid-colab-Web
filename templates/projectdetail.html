{% extends "master.html" %}

{% block content %}
          {% if info %}
          
			  <div class="alert alert-success" role="alert">
			  {{ info }}
			  </div>
		  {% endif %}
		  
		  {% if alert %}
			  <div class="alert alert-danger" role="alert">
			  <span class="sr-only">Error:</span>
			  {{ alert }}
			  </div>
		  {% endif %}
		       	
      <!-- column 2 -->	
       <h3> {{ heading }}</h3>
       <hr>
       
       {{ headingcontent | raw }}
       
       <div class="panel-group" id="accordion">
       {{ milestonecontent | raw }}	    
        
        {% if finished == false %}
        <hr>
        <h3>Steps :</h2>
       	<p>1. Click create document to add document in current milestone.</p>
       	<p>2. Signer sign the document.</p>
       	<p>3. Create milestone to add new milestone.</p>
       	<p>4. Click project finished to finalize project.</p>
       	<p>4. Download and save project report to your computer for future proof.</p>
       	<hr>
		<form class="input-append" role="form" name="newdocument" action="{{ WebAddr }}/document/create" method="post">
		<input type="hidden" name="projectname" id="projectname" value="{{ projectname }}" />
		<input type="hidden" name="projectnumber" id="projectnumber" value="{{ projectnumber }}" />
		<input type="hidden" name="currentmilestone" id="currentmilestone" value="{{ currentmilestone }}" />
		<input type="hidden" name="milestonenumber" id="milestonenumber" value="{{ milestonenumber }}" />
		<button type="submit" class="btn btn-default btn-sm"><b>Create Document</b></button></form>
		<hr>
        {% endif %}
           
		
	   
	    {{ milestonedropdown | raw }}
	    
		<hr>
        
        {% if iscreator and finished == false %}
        <button class="btn btn-default btn-sm milestonedelete-btn"><b>Delete Last Milestone</b></button>
        <form class="form-inline">
	        <div class="form-group">
	        <input type="text" class="form-control" name="milestonename" id="milestonename" placeholder="Milestone Name">
	        </div>
	        <button class="btn btn-default btn-sm milestonenext-btn"><b>Create Next Milestone</b></button>
	    </form>
        <button class="btn btn-default btn-sm projectfinish-btn"><b>Finish Project</b></button>
        <button class="btn btn-danger  btn-sm projectdelete-btn"><b>Delete Project</b></button>
        
        <hr>
        
        <script>
        $(document).on('click','.milestonedelete-btn',function(){
		    $.ajax(
		    {
		        url: '{{ WebAddr }}/project/milestone/delete',
		        type: "POST",
		        
		        data: {"projectnumber": "{{ projectnumber }}"},
		        success: function (result) {
					 //alert(result);
                     window.location.reload();
		        }
		    });
		});
        
        $(document).on('click','.milestonenext-btn',function(){
		    $.ajax(
		    {
		        url: '{{ WebAddr }}/project/next',
		        type: "POST",
		        
		        data: {"projectnumber": "{{ projectnumber }}", "milestonename":$("input#milestonename").val()},
		        success: function (result) {
					//alert(result);
                    window.location.reload();
		        }
		    });
		});
            
        $(document).on('click','.projectfinish-btn',function(){
		    $.ajax(
		    {
		        url: '{{ WebAddr }}/project/finish',
		        type: "POST",
		        
		        data: {"projectnumber": "{{ projectnumber }}"},
		        success: function (result) {
					 //alert(result);
                     window.location.reload();
		        }
		    });
		});
		
		$(document).on('click','.projectdelete-btn',function(){
		    $.ajax(
		    {
		        url: '{{ WebAddr }}/project/delete',
		        type: "POST",
		        
		        data: {"projectnumber": "{{ projectnumber }}"},
		        success: function (result) {
					 //alert(result);
                     window.location.reload();
		        }
		    });
		});
		</script>

        {% endif %}
        
        {% if finished %}
        <a class="btn btn-sm btn-default" target="_blank" href="{{ reporturl }}"><b>Download Project Report</b></a>
        {% endif %}

{% endblock %}